rm(list = ls())
# library statements
library(dplyr)
library(stringr)
library(testthat)
sleep_df <- read.csv("Sleep_health_and_lifestyle_dataset.csv")
job_df <- read.csv("Occupation Employment and Wage Statistics.csv")
conversion_df <- read.csv("Occupation Conversion Chart one-on-one.csv")
conversion_df <- read.csv("Occupation Conversion Chart one-on-one.csv")
library(dplyr)
library(stringr)
library(testthat)
# Loads in two data sets and the conversion chart
sleep_df <- read.csv("Sleep_health_and_lifestyle_dataset.csv")
setwd("/Users/sera/Downloads/INFO201/GitHub/Info_201_Final_Project")
library(dplyr)
library(stringr)
library(testthat)
# Loads in two data sets and the conversion chart
sleep_df <- read.csv("Sleep_health_and_lifestyle_dataset.csv")
job_df <- read.csv("Occupation Employment and Wage Statistics.csv")
conversion_df <- read.csv("Occupation Conversion Chart one-on-one.csv")
View(conversion_df)
job_wages_df <- job_df %>% select(OCC_TITLE, H_MEAN, A_MEAN)
View(job_wages_df)
combined_df <- sleep_df %>%
left_join(conversion_df, by = c("Occupation" = "Occupation_sleep"), relationship = "many-to-many") %>%
left_join(job_wages_df, by = c("Corresponding.Occupation_job" = "OCC_TITLE"), relationship = "many-to-many") %>%
distinct(Person.ID, .keep_all = TRUE)
View(combined_df)
med_sleep <- median(combined_df$Sleep.Duration)
combined_df <- combined_df %>%
mutate(above_med_hours = ifelse(Sleep.Duration > med_sleep, TRUE, FALSE))
combined_df <- combined_df %>%
mutate(percent_steps_daily = Daily.Steps/10000)
percentage_occupation <- combined_df %>%
group_by(combined_df$Occupation) %>%
summarize(percentage = round(n() / nrow(combined_df) * 100))
View(percentage_occupation)
View(percentage_occupation)
View(percentage_occupation)
rm(list = ls())
library(dplyr)
library(stringr)
library(testthat)
sleep_df <- read.csv("Sleep Health and Lifestyle Dataset.csv")
job_df <- read.csv("Occupation Employment and Wage Statistics.csv")
conversion_df <- read.csv("Occupation Conversion Chart.csv")
job_wages_df <- job_df %>% select(OCC_TITLE, H_MEAN, A_MEAN)
# Combines all data frames into one
combined_df <- sleep_df %>%
left_join(conversion_df, by = c("Occupation" = "Occupation_sleep"), relationship = "many-to-many") %>%
left_join(job_wages_df, by = c("Corresponding.Occupation_job" = "OCC_TITLE"), relationship = "many-to-many") %>%
distinct(Person.ID, .keep_all = TRUE)
View(combined_df)
sleep_median <- median(combined_df$Sleep.Duration)
combined_df <- combined_df %>%
mutate(above_med_hours = ifelse(Sleep.Duration > sleep_median, TRUE, FALSE))
combined_df <- combined_df %>%
mutate(perc_daily_steps = (Daily.Steps / 10000) * 100)
combined_df <- combined_df %>%
mutate(perc_daily_steps = (Daily.Steps / 10000) * 100)
percentage_occupation <- combined_df %>%
group_by(combined_df$Occupation) %>%
summarize(percentage = round(n() / nrow(combined_df) * 100))
View(percentage_occupation)
View(combined_df)
write.csv(combined_df, "Sleep and Occupation Combined Dataset.csv")
View(conversion_df)
View(percentage_occupation)
View(job_df)
View(sleep_df)
View(conversion_df)
View(percentage_occupation)
View(job_wages_df)
View(conversion_df)
View(combined_df)
